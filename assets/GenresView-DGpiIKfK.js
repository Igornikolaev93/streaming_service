import{d as E,r as i,l as x,a as c,o as d,b as r,F as A,e as C,m as w,t as m,g as F,_ as D}from"./index-DCwIKAqD.js";/* empty css                                                   *//* empty css                                                                   */const B={class:"genres-container"},G={key:0,class:"loading"},R={key:1},U={class:"catalog"},I=["onClick"],M={class:"genre-image-container"},P=["src","alt"],$={class:"genre-text"},j={class:"genre-name"},S=E({__name:"GenresView",setup(V){const g=i(!1),v=i([]),o=i([]),f=i({}),h=F();i("");async function y(n){const e={};return o.value.forEach(t=>{const s=n.filter(a=>a.genres&&a.genres.includes(t));if(s.length>0){const a=s.sort((l,u)=>(u.tmdbRating||0)-(l.tmdbRating||0))[0];if(a.posterUrl)e[t]=a.posterUrl;else{const l=s.find(u=>u.posterUrl);l&&(e[t]=l.posterUrl)}}e[t]||(e[t]=p(t))}),e}function p(n){const e=["4A5568","38A169","E53E3E","805AD5","3182CE","1A202C","F56565","DD6B20","2D3748","744210","2C7A7B","38B2AC","319795","D69E2E","718096","B83280","276749"];return`https://via.placeholder.com/300x450/${e[Math.abs(n.split("").reduce((s,a)=>s+a.charCodeAt(0),0))%e.length]}/FFFFFF?text=${encodeURIComponent(n)}`}function _(n){h.push(`/genres/${encodeURIComponent(n)}`)}async function b(){g.value=!0;try{const[n,e]=await Promise.all([fetch("https://cinemaguide.skillbox.cc/movie"),fetch("https://cinemaguide.skillbox.cc/movie/genres")]);if(!n.ok||!e.ok)throw new Error("Failed to fetch data");const t=await n.json(),s=await e.json();if(v.value=t.movies||t.items||t||[],Array.isArray(s))o.value=s;else if(s.genres&&Array.isArray(s.genres))o.value=s.genres;else if(typeof s=="object")o.value=Object.values(s).filter(a=>typeof a=="string");else throw new Error("Unexpected genres data format");f.value=await y(v.value)}catch(n){console.error("Error loading data:",n),o.value=["драма","комедия","боевик","триллер","фантастика","ужасы","романтика","приключения","детектив","фэнтези","исторический","биография","мультфильм","семейный","вестерн"];const e={};o.value.forEach(t=>{e[t]=p(t)}),f.value=e}finally{g.value=!1}}function k(n){const e=["linear-gradient(135deg, #667eea 0%, #764ba2 100%)","linear-gradient(135deg, #f093fb 0%, #f5576c 100%)","linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)","linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)","linear-gradient(135deg, #fa709a 0%, #fee140 100%)","linear-gradient(135deg, #a8caba 0%, #5d4157 100%)","linear-gradient(135deg, #5ee7df 0%, #b490ca 100%)","linear-gradient(135deg, #d299c2 0%, #fef9d7 100%)","linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%)","linear-gradient(135deg, #fd746c 0%, #ff9068 100%)"],t=Math.abs(n.split("").reduce((s,a)=>s+a.charCodeAt(0),0))%e.length;return e[t]}return x(()=>{b()}),(n,e)=>(d(),c("div",B,[g.value?(d(),c("div",G,[...e[1]||(e[1]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Загрузка жанров...",-1)])])):(d(),c("div",R,[e[3]||(e[3]=r("div",{class:"cart"},null,-1)),e[4]||(e[4]=r("h2",null," Жанры фильмов",-1)),r("div",U,[(d(!0),c(A,null,C(o.value,(t,s)=>(d(),c("div",{class:"genre-card",key:s,onClick:a=>_(t)},[r("div",M,[r("img",{class:"genre-image",src:f.value[t],alt:`Фильмы в жанре ${t}`,onError:e[0]||(e[0]=a=>{a.target.style.display="none";const l=a.target.parentElement?.querySelector(".genre-gradient-fallback");l&&(l.style.display="flex")})},null,40,P),r("div",{class:"genre-gradient-fallback",style:w({background:k(t)})},[r("span",$,m(t),1)],4),e[2]||(e[2]=r("div",{class:"genre-overlay"},[r("span",{class:"genre-overlay-text"},"Смотреть фильмы")],-1))]),r("div",j,m(t),1)],8,I))),128))])]))]))}}),O=D(S,[["__scopeId","data-v-05100b71"]]);export{O as default};
